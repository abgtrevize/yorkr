{
    "collab_server" : "",
    "contents" : "##########################################################################################\n# Designed and developed by Tinniam V Ganesh\n# Date : 23 Mar 2016\n# Function: teamBattingBattingScorecardOppnAllMatches\n# This function computes the batting scorecard for the team against an oppositon\n# in all matches against the opposition\n#\n#\n###########################################################################################\n#' @title\n#' Compute and return the batting scorecard of a team in all matches against an opposition\n#'\n#' @description\n#' This function computes returns the batting scorecard (runs, fours, sixes, balls played) for the\n#' team in all matches against an opposition\n#'\n#' @usage\n#' teamBattingScorecardMatch(matches,main,opposition)\n#'\n#' @param matches\n#' the data frame of all matches between a team and an opposition obtained with\n#' the call getAllMatchesBetweenteam()\n#'\n#' @param main\n#' The main team for which scorecard required\n#'\n#' @param opposition\n#' The opposition team\n#'\n#' @return scorecard\n#' The scorecard of all the matches\n#'\n#' @references\n#' \\url{http://cricsheet.org/}\\cr\n#' \\url{https://gigadom.wordpress.com/}\n#' @author\n#' Tinniam V Ganesh\n#' @note\n#' Maintainer: Tinniam V Ganesh \\email{tvganesh.85@gmail.com}\n#'\n#' @examples\n#' # Get all matches between India and Australia\n#' matches <- getAllMatchesBetweenTeams(\"India\",\"Australia\",dir=\"../data\",save=TRUE)\n#' # Compute the scorecard of India in matches with australia\n#' teamBattingScorecardOppnAllMatches(matches,main=\"India\",opposition=\"Australia\")\n#'\n#' #Get all matches between Australia and India\n#' matches <- getAllMatchesBetweenTeams(\"Australia\",\"India\",dir=\"../data\")\n#' #Compute the batting scorecard of Australia\n#' teamBattingScorecardOppnAllMatches(matches,\"Australia\",\"India\")\n#'\n#' @seealso\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatches}}\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatchesPlot}}\n#' \\code{\\link{teamBatsmanPartnershipOppnAllMatchesChart}}\n#'\n#' @export\n#'\nteamBattingScorecardOppnAllMatches <- function(matches,main,opposition){\n\n\n    a <-filter(matches,team==main)\n    b <- select(a,batsman,runs)\n\n    names(b) <-c(\"batsman\",\"runs\")\n    #Compute the number of 4s\n    c <-\n        b %>%\n        mutate(fours=(runs>=4 & runs <6)) %>%\n        filter(fours==TRUE)\n\n    # Group by batsman. Count 4s\n    d <-    summarise(group_by(c, batsman),fours=n())\n\n    # Get the total runs for each batsman\n    e <-summarise(group_by(a,batsman),sum(runs))\n    names(b) <-c(\"batsman\",\"runs\")\n    details <- full_join(e,d,by=\"batsman\")\n    names(details) <-c(\"batsman\",\"runs\",\"fours\")\n\n    # Compute sixes\n    f <-\n        b %>%\n        mutate(sixes=(runs ==6)) %>%\n        filter(sixes == TRUE)\n    # Group by batsman. COunt 6s\n    g <- summarise(group_by(f, batsman),sixes=n())\n    names(g) <-c(\"batsman\",\"sixes\")\n\n    #Full join with 4s and 6s\n    details <- full_join(details,g,by=\"batsman\")\n\n    # Count the balls played by the batsman\n    ballsPlayed <-\n        a  %>%\n        select(batsman,byes,legbyes,wides,noballs,runs) %>%\n        filter(wides ==0,noballs ==0,byes ==0,legbyes == 0) %>%\n        select(batsman,runs)\n\n    ballsPlayed<- summarise(group_by(ballsPlayed,batsman),count=n())\n    names(ballsPlayed) <- c(\"batsman\",\"ballsPlayed\")\n    details <- full_join(details,ballsPlayed,by=\"batsman\")\n    cat(\"Total=\",sum(details$runs),\"\\n\")\n    details <- arrange(details,desc(runs),desc(sixes),desc(fours))\n    details <- select(details,batsman,ballsPlayed,fours,sixes,runs)\n    details\n\n}\n",
    "created" : 1459002293566.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4091440032",
    "id" : "81489109",
    "lastKnownWriteTime" : 1459003234,
    "last_content_update" : 1459003234912,
    "path" : "C:/software/cricket-package/york-test/yorkr/R/teamBattingScoredcardOppnAllMatches.R",
    "project_path" : "R/teamBattingScoredcardOppnAllMatches.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}