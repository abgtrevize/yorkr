{
    "collab_server" : "",
    "contents" : "##########################################################################################\n# Designed and developed by Tinniam V Ganesh\n# Date : 23 Mar 2016\n# Function: teamBowlersVsBatsmanOppnAllMatches\n# This function computes the performance of the bowlers and the runs conceded and the batsman\n# who scored most\n#\n#\n###########################################################################################\n#' @title\n#' Compute the performance of bowlers of a team against an opposition in all matches\n#'\n#' @description\n#' This function computes performance of bowlers of a team against an opposition in all matches\n#' against the opposition\n#'\n#' @usage\n#' teamBowlersVsBatsmanOppnAllMatches(match,main,opposition,plot=TRUE,top=5)\n#'\n#' @param match\n#' The data frame of all matches between a team the opposition. This dataframe can be obtained with\n#' matches <- getAllMatchesBetweenTeams(\"Australia\",\"India\",dir=\"../data\")\n#'\n#' @param theTeam\n#' The team against which the performance is requires\n#'\n#' @param rank\n#' When the rank is 0 then the performance of all the bowlers is displayed. If rank=n (1,2,3 ..) then\n#' the performance of that bowler is given\n#'\n#' @return dataframe\n#' The dataframe with all performances\n#'\n#' @references\n#' \\url{http://cricsheet.org/}\\cr\n#' \\url{https://gigadom.wordpress.com/}\n#' @author\n#' Tinniam V Ganesh\n#' @note\n#' Maintainer: Tinniam V Ganesh \\email{tvganesh.85@gmail.com}\n#'\n#' @examples\n#' # Get all matches between India and Australia\n#' matches <- getAllMatchesBetweenTeams(\"Australia\",\"India\",dir=\"../data\")\n#'\n#' #  Plot the performance of top 5 Indian bowlers against Australia\n#' teamBowlersVsBatsmanOppnAllMatches(matches,'India',\"Australia\",top=5)\n#'\n#' # Plot the performance of top 3 Australian bowlers against India\n#' teamBowlersVsBatsmanOppnAllMatches(matches,\"Australia\",\"India\",top=3)\n#'\n#' # Get the top 5 bowlers of Australia. Do not plot but get as a dataframe\n#' teamBowlersVsBatsmanOppnAllMatches(matches,\"Australia\",\"India\",plot=FALSE)\n#'\n#' @seealso\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatches}}\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatchesPlot}}\n#' \\code{\\link{teamBatsmanPartnershipOppnAllMatchesChart}}\n#' \\code{\\link{teamBowlersVsBatsmanAllOppnAllMatchesRept}}\n#' \\code{\\link{teamBowlersVsBatsmanAllOppnAllMatchesPlot}}\n#'\n#' @export\n#'\nteamBowlersVsBatsmanOppnAllMatches <- function(match,main,opposition,plot=TRUE,top=5){\n\n    a <-filter(match,team != main)\n\n    b <-summarise(group_by(a,bowler,batsman),sum(runs))\n    names(b) <- c(\"bowler\",\"batsman\",\"runsConceded\")\n    # Compute total runs conceded\n    c <- summarise(group_by(b,bowler),runs=sum(runsConceded))\n    # Sort by descneding\n    d <- arrange(c,desc(runs))\n\n    # Pick 5 highest run givers\n    d <- head(d,top)\n\n    bowlers <- as.character(d$bowler)\n    e <- NULL\n    for(i in 1:length(bowlers)){\n        f <- filter(b,bowler==bowlers[i])\n        e <- rbind(e,f)\n\n    }\n    names(e) <- c(\"bowler\",\"batsman\",\"runsConceded\")\n\n    if( plot == TRUE){\n        plot.title = paste(\"Bowlers vs batsmen -\",main,\" Vs \",opposition,\"(all matches)\",sep=\"\")\n        ggplot(data=e,aes(x=batsman,y=runsConceded,fill=factor(batsman))) +\n            facet_grid(. ~ bowler) + geom_bar(stat=\"identity\") +\n            #facet_wrap( ~ bowler,scales = \"free\", ncol=3,drop=TRUE) + #Does not work.Check!\n            xlab(\"Batsman\") + ylab(\"Runs conceded\") +\n            ggtitle(bquote(atop(.(plot.title),\n                                    atop(italic(\"Data source:http://cricsheet.org/\"),\"\")))) +\n            theme(axis.text.x = element_text(angle = 90, hjust = 1))\n    } else{\n        e\n    }\n}\n",
    "created" : 1459008019421.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1595378638",
    "id" : "6F084DBD",
    "lastKnownWriteTime" : 1459008402,
    "last_content_update" : 1459008402502,
    "path" : "C:/software/cricket-package/york-test/yorkr/R/teamBowlerVsBatsmanOppnAllMatches.R",
    "project_path" : "R/teamBowlerVsBatsmanOppnAllMatches.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}