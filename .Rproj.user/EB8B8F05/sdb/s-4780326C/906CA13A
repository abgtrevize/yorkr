{
    "collab_server" : "",
    "contents" : "##########################################################################################\n# Designed and developed by Tinniam V Ganesh\n# Date : 24 Mar 2016\n# Function: teamBowlerWicketKindOppnAllMatches\n# This function computes the the types of wickets taken by the bowlers, caught,bowled, c&b etc\n#\n#\n###########################################################################################\n#' @title\n#' Compute the performance of bowlers of a team  and the wicket kind against an\n#' opposition in all matches\n#'\n#' @description\n#' This function computes performance of bowlers of a team and the wicket kind against an\n#' opposition in all matches against the opposition\n#'\n#' @usage\n#' teamBowlerWicketKindOppnAllMatches(matches,main,opposition,plot=TRUE)\n#'\n#' @param matches\n#' The data frame of all matches between a team the opposition. This dataframe can be obtained with\n#' matches <- getAllMatchesBetweenTeams(\"Australia\",\"India\",dir=\"../data\")\n#'\n#' @param main\n#' The team for which the performance is required\n#'\n#' @param opposition\n#' The opposing team\n#'\n#' @param plot\n#' If plot=TRUE then a plot is displayed else a dataframe is returned\n#'\n#' @return None or dataframe\n#' The return depends on the value of the plot\n#'\n#' @references\n#' \\url{http://cricsheet.org/}\\cr\n#' \\url{https://gigadom.wordpress.com/}\n#' @author\n#' Tinniam V Ganesh\n#' @note\n#' Maintainer: Tinniam V Ganesh \\email{tvganesh.85@gmail.com}\n#'\n#' @examples\n#' # Get all matches between India and Australia\n#' matches <- getAllMatchesBetweenTeams(\"Australia\",\"India\",dir=\"../data\")\n#'\n#' teamBowlerWicketKindOppnAllMatches(matches,\"India\",\"Australia\",plot=TRUE)\n#' m <- teamBowlerWicketKindOppnAllMatches(matches,\"Australia\",\"India\",plot=FALSE)\n#'\n#' teamBowlerWicketKindOppnAllMatches(matches,\"Australia\",\"India\",plot=TRUE)\n#'\n#' @seealso\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatches}}\n#' \\code{\\link{teamBatsmanPartnershipAllOppnAllMatchesPlot}}\n#' \\code{\\link{teamBatsmanPartnershipOppnAllMatchesChart}}\n#' \\code{\\link{teamBowlersVsBatsmanAllOppnAllMatchesRept}}\n#' \\code{\\link{teamBowlersVsBatsmanAllOppnAllMatchesPlot}}\n#'\n#' @export\n#'\nteamBowlerWicketKindOppnAllMatches <- function(matches,main,opposition,plot=TRUE){\n\n    # Compute the maidens,runs conceded and overs for the bowlers\n    a <-filter(matches,team !=main)\n\n    # only wides and noballs need to be included with runs for bowlers.\n    # Note: byes and legbyes should not be included\n    b <-  a %>%\n        select(bowler,ball,noballs,wides,runs,wicketKind,wicketPlayerOut) %>%\n        mutate(over=gsub(\"1st\\\\.\",\"\",ball)) %>%\n        mutate(over=gsub(\"\\\\.\\\\d+\",\"\",over))\n\n    #Calculate the number of maiden overs\n    c <- summarise(group_by(b,bowler,over),sum(runs,wides,noballs))\n    names(c) <- c(\"bowler\",\"over\",\"runsConceded\")\n    d <-summarize(group_by(c,bowler),maidens=sum(runsConceded==0))\n\n    #Compute total runs conceded (runs_wides+noballs)\n    e <- summarize(group_by(c,bowler),runs=sum(runsConceded))\n\n\n    #Compute number of wickets\n    h <- b %>%\n        select(bowler,wicketKind,wicketPlayerOut) %>%\n        filter(wicketPlayerOut != \"nobody\")\n    i <- summarise(group_by(h,bowler),wickets=length(unique(wicketPlayerOut)))\n\n    r <- full_join(h,e,by=\"bowler\")\n\n    # Set NAs to 0\n    if(sum(is.na(r$wicketKind)) != 0){\n        r[is.na(r$wicketKind),]$wicketKind=\"noWicket\"\n    }\n    if(sum(is.na(r$wicketPlayerOut)) !=0){\n        r[is.na(r$wicketPlayerOut),]$wicketPlayerOut=\"noWicket\"\n    }\n\n    if(plot == TRUE){\n        plot.title = paste(\"Wicket kind taken by bowlers -\",main,\" Vs \",opposition,\"(all matches)\",sep=\"\")\n        ggplot(data=r,aes(x=wicketKind,y=runs,fill=factor(wicketKind))) +\n            facet_wrap( ~ bowler,scales = \"fixed\", ncol=8) +\n            geom_bar(stat=\"identity\") +\n            xlab(\"Wicket kind\") + ylab(\"Runs conceded\") +\n            ggtitle(bquote(atop(.(plot.title),\n                                atop(italic(\"Data source:http://cricsheet.org/\"),\"\")))) +\n            theme(axis.text.x = element_text(angle = 90, hjust = 1))\n    }\n    else{\n        r\n    }\n\n\n}\n",
    "created" : 1459009244618.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2156357451",
    "id" : "906CA13A",
    "lastKnownWriteTime" : 1459009489,
    "last_content_update" : 1459009489322,
    "path" : "C:/software/cricket-package/york-test/yorkr/R/teamBowlerWicketKindOppnAllMatches.R",
    "project_path" : "R/teamBowlerWicketKindOppnAllMatches.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}